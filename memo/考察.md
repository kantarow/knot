## S+について

S+には二種類ある。
1. Odd追加
2. Even追加

である。

### 前提
1. ある頂点を始点かつ終点として、全ての辺を一回ずつ通るような経路が存在する。(ひもの性質より)
2. ある頂点を始点かつ終点として、辺の重複なく、かつ始点を2回しか通らない経路が存在する。
3. OddまたはEvenブロックが一個以上ある場合、そのブロックを始点かつ終点とした、互いに辺の重複が無い経路が二つ得られる。(有向グラフとみた場合)

これはEven追加の時に使う。

### Odd追加
前提2の経路を考える。その内二つの辺を選ぶと、必ず向きが反対になる。そのためここにOddを追加できる。

この経路を(a, b)...(c, d)...(?, a)と表すとき、(a, b), (c, d)を消去し(a, O)(b, O) (O, c)(O, d)の辺を追加することで前提を保ったままOddの追加ができる。(?, a) == (c, d)でもよい。

追記：(a, b)と(?, a)の間にある辺は逆転する？(step2-3からste3-5を生やすにはそう定義するしかない気がする)

### Even追加
前提3の経路を考える。それぞれ経路A, Bとすると

A: (a, b)...(?, a)  
B: (a, ?)...(c, a)

となる。この時(a, b)(c, a)を消去し(a, E)(E, b) (c, E)(E, a)の辺を追加することでEvenの追加ができる。

---

## 空頂点の削除について。
ある空頂点iが存在し、辺(a, i)と(i, b)が存在する場合、その2辺を削除し(a, b)の辺を追加することができる。

---

## 頂点の分割について
頂点は
+ Odd→Odd+Even
+ Even→Odd+Odd | Even+Even

に分割出来る。

まずはOddのタイプを判別する必要がある。typeAとtypeBである。そのOを始点にした経路を二つ用意し、それらが異なるならtypeA, 同じならtypeBである。


### OddがtypeAの場合の分割
(O, a), (O, b)を削除し、(O, E), (E, a) (O, E), (E, b)を追加する。

### OddがtypeBの場合の分割
Oを一回ずつだけ通る経路[(O, a)...(b, O)]を見つける。(O, a), (b, O)を削除し(O, E), (E, a), (b, E), (E, O)を追加する。

Evenのタイプ判別はOddの逆である。

### EvenがtypeAの場合の分割
(a, E), (b, E), (E, c), (E, d)を削除し、(a, O1), (b, O1), (O1, O2), (O1, O2), (O2, c), (O2, d)を追加する。

### EvenがtypeBの場合の分割
分かり次第書きます。